<?xml version="1.0" encoding="UTF-8"?>
<openerp>
<data>
    <record id="runbot_send_notif" model="mail.template">
        <field name="name">Send Email Notification Status</field>
        <field name="model_id" ref="runbot.model_runbot_build"/>
        <field name="subject">${object.subject_email}</field>
        <field name="body_html"><![CDATA[
    <table style="padding:0px;border:0px;width:100%;color:#606060;font-size:19px;margin-bottom:15px;margin-top:15px">
        <tbody><tr style="padding:0px;border:0px">
            <td style="padding:0px;border:0px;vertical-align:middle">
                <span style="vertical-align:middle;margin-left:3px">
                    <strong><a href="${object.repo_id.name}" style="text-decoration:underline;color:#606060" target="_blank">${object.repo_name}</a></strong> (<a href="${object.repo_id.name.replace('.git', '')}${object.branch_id.name.replace('refs', '')}" style="text-decoration:underline;color:#606060" target="_blank">${object.branch_name}</a>)</span>
            </td>
        </tr>
        </tbody>
    </table>
    <div style="border-radius:5px;padding:0px;width:570px;font-size:13px">
        <div>
          <table style="padding:0px;border:0px;width:100%;border-spacing:0">
            <thead>
% if object.state=="testing":
              <tr style="padding:0px;border:0px;font-weight:700;font-size:18px;background-color:#d9edf7;color:#1400FB">
                <td style="padding:0px;border:0px;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;width:50px;padding:0px;text-align:center;vertical-align:middle;padding-top:5px;border-left:1px solid #606060;border-top-left-radius:5px"><div style="width:25px;min-height:30px;margin-left:15px;margin-top:0px;vertical-align:middle"><img class="CToWUd" src="http://fa2png.io/media/icons/fa-spinner/25/0/2b3cad_none.png" height="25" width="25"></div></td>
                <td style="padding:0px;border:0px;padding:0px 20px 10px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad">
                    <span style="display:inline-block;margin-top:12px;vertical-align:middle"><a href="${object.log_link}" style="text-decoration:underline;text-decoration:none;font-weight:bold;color:#57769d;text-decoration:underline;color:#1400FB" target="_blank">
Build #${object.sequence} is ${object.state}
</a></span>
</td>
                <td style="padding:0px;border:0px;font-weight:normal;font-size:12px;vertical-align:middle;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;border-right:1px solid #606060;border-top-right-radius:5px" align="right">
<div style="vertical-align:middle;min-height:20px;width:20px;padding:20px;display:inline-block;width:20px;min-height:20px"></div> <span style="vertical-align:middle">Age: ${object.job_age}m</span>
</td>
              </tr>
% elif (object.state=="running" or object.state=="done") and (object.result=="ok"):
              <tr style="padding:0px;border:0px;font-weight:700;font-size:18px;background-color:#baecb7;color:#32a32d">
                  <td style="padding:0px;border:0px;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;width:50px;padding:0px;text-align:center;vertical-align:middle;padding-top:5px;border-left:1px solid #606060;border-top-left-radius:5px"><div style="width:25px;min-height:30px;margin-left:15px;margin-top:0px;vertical-align:middle"><img class="CToWUd" src="http://fa2png.io/media/icons/fa-thumbs-up/25/0/50ad57_none.png" height="25" width="25"></div></td>
                <td style="padding:0px;border:0px;padding:0px 20px 10px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad">
                    <span style="display:inline-block;margin-top:12px;vertical-align:middle"><a href="${object.log_link}" style="text-decoration:underline;text-decoration:none;font-weight:bold;color:#57769d;text-decoration:underline;color:#32a32d" target="_blank">
Build #${object.sequence} is ${object.state}
</a></span>
</td>
                <td style="padding:0px;border:0px;font-weight:normal;font-size:12px;vertical-align:middle;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;border-right:1px solid #606060;border-top-right-radius:5px" align="right">
                    <div style="vertical-align:middle;min-height:20px;width:20px;padding:20px;display:inline-block;width:20px;min-height:20px"></div> <span style="vertical-align:middle">Age: ${object.job_age}m</span>
</td>
              </tr>
% else:
              <tr style="padding:0px;border:0px;font-weight:700;font-size:18px;background-color:#EFBABA;color:#FF0000">
                  <td style="padding:0px;border:0px;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;width:50px;padding:0px;text-align:center;vertical-align:middle;padding-top:5px;border-left:1px solid #606060;border-top-left-radius:5px"><div style="width:25px;min-height:30px;margin-left:15px;margin-top:0px;vertical-align:middle"><img class="CToWUd" src="http://fa2png.io/media/icons/fa-thumbs-down/25/0/ff0000_none.png" height="25" width="25"></div></td>
                <td style="padding:0px;border:0px;padding:0px 20px 10px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad">
                    <span style="display:inline-block;margin-top:12px;vertical-align:middle"><a href="${object.log_link}" style="text-decoration:underline;text-decoration:none;font-weight:bold;color:#57769d;text-decoration:underline;color:#FF0000" target="_blank">
Build #${object.sequence} is ${object.state} but failed
</a></span>
</td>
                <td style="padding:0px;border:0px;font-weight:normal;font-size:12px;vertical-align:middle;padding:0px 20px 0px 0px;vertical-align:middle;border-top:1px solid #808080;border-bottom:1px solid #adadad;border-right:1px solid #606060;border-top-right-radius:5px" align="right">
                    <div style="vertical-align:middle;min-height:20px;width:20px;padding:20px;display:inline-block;width:20px;min-height:20px"></div> <span style="vertical-align:middle">Age: ${object.job_age}m</span>
</td>
              </tr>
% endif
            </thead>
            <tbody style="margin-bottom:40px">
              <tr style="padding:0px;border:0px">
                <td style="padding:0px;border:0px;padding:10px 20px 10px 0px;height:20px;width:20px;padding:0px;border-left:1px solid #adadad;padding-top:20px;padding-bottom:5px;text-align:center"></td>
                <td style="padding:0px;border:0px;color:#808080;padding:10px 20px 10px 0px;height:20px;padding-top:20px;padding-bottom:5px"><strong>${object.committer}</strong></td>
                <td style="padding:0px;border:0px;color:#808080;padding:10px 20px 10px 0px;height:20px;border-right:1px solid #adadad;padding-top:20px;padding-bottom:5px;font-size:12px" align="right">changeset <a href="${object.repo_id.name.replace('.git', '')}/commit/${object.name[:8]}" style="text-decoration:underline;color:#606060" target="_blank">${object.name[:8]}</a></td>
              </tr>
              <tr style="padding:0px;border:0px">
                <td style="padding:0px;border:0px;padding:10px 20px 10px 0px;height:20px;width:20px;padding:0px;border-left:1px solid #adadad;border-bottom-left-radius:5px;border-bottom:1px solid #adadad">&nbsp;</td>
                <td colspan="2" style="padding:0px;border:0px;color:#808080;padding:10px 20px 10px 0px;height:20px;border-right:1px solid #adadad;padding-bottom:20px;padding-top:0px;border-bottom:1px solid #adadad;border-bottom-right-radius:5px">${object.subject}</td>
              </tr>
              </tbody>
          </table>
        </div>
    </div>

<!-- System Message -->
% if object.state=="testing":
      <div style="width:528px;padding:10px 20px;border:1px solid #adadad;border-radius:5px;font-size:12px;margin-bottom:0px;background-color:#fbfddc;margin-top:20px">
        <span style="color:#808080">
          <b>System message:</b>
          <p style="margin-top:5px;margin-bottom:0px">
              Your Build is ${object.state}, You must wait until runbot finish this process. As soon change of status, runbot will send another notice to this effect.
              <br/>Thank you for your patience.
          </p>
        </span>
      </div>
% elif (object.state=="running" or object.state=="done") and (object.result=="ok"):
      <div style="width:528px;padding:10px 20px;border:1px solid #adadad;border-radius:5px;font-size:12px;margin-bottom:0px;background-color:#fbfddc;margin-top:20px">
        <span style="color:#808080">
          <b>System message:</b>
          <p style="margin-top:5px;margin-bottom:0px">
              Your Build is ${object.state} and runbot test completed successfully.
              <br/>Thank you for your patience.
          </p>
        </span>
      </div>
% else:
      <div style="width:528px;padding:10px 20px;border:1px solid #adadad;border-radius:5px;font-size:12px;margin-bottom:0px;background-color:#fbfddc;margin-top:20px">
        <span style="color:#808080">
          <b>System message:</b>
          <p style="margin-top:5px;margin-bottom:0px">
              Your Build is ${object.state} but runbot test completed unsuccessfully. Please read the runbot logs and fix the issues found.
              <br/>Thank you for your patience.
          </p>
        </span>
      </div>
% endif

<!-- functionally -->
      <div style="padding-top:10px;width:570px">
        <span>
          <div style="margin-top:20px;border-radius:5px;border:1px solid #adadad;font-size:12px;padding:10px 20px;width:528px">
            <p style="color:#808080;margin-top:0px;margin-bottom:5px"><strong style="font-size:14px">Do you want to debug this instance throught ssh or functionally?</strong></p>
            <p style="color:#808080;margin-top:0px;margin-bottom:5px;margin-bottom:5px">
                <strong>Web Access:</strong> You can has access to this build directly throught this <a href="${object.webaccess_link}" style="text-decoration:underline;color:#606060" target="_blank">Here</a>.
            </p>
            <p style="color:#808080;margin-top:0px;margin-bottom:5px;margin-bottom:5px">
                <strong>Log:</strong> You can has access to the logs of this build on plain text <a href="${object.logplainbase_link}" style="text-decoration:underline;color:#606060" target="_blank">Here</a> and <a href="${object.logplainall_link}" style="text-decoration:underline;color:#606060" target="_blank">Here</a> or to the log of the running instance <a href="${object.log_link}" style="text-decoration:underline;color:#606060" target="_blank">Here</a>.
            </p>
            <p style="color:#808080;margin-top:0px;margin-bottom:5px;margin-bottom:5px">
                <strong>SSH:</strong> You can has access to this build with the command <code style="font-family:monospace;background-color: #E0E0E0;">  ${object.ssh_link}  </code>. if it give you an access denied in the connection process you can ask for access to this email (<a href="mailto:moylop260@vauxoo.com" style="text-decoration:underline;color:#606060" target="_blank">moylop260@vauxoo.com</a>) sending your public key as attachment.
            </p>
          </div>
        </span>
      </div>

<!-- Documentation -->
      <table style="padding:0px;border:0px;width:100%;background-color:#e9e6e7;border-radius:5px;border:1px solid #adadad;padding:10px;margin-top:20px;font-size:12px;width:570px;line-height:16px" border="0">
        <tbody><tr style="padding:0px;border:0px">
          <td style="padding:0px;border:0px">
          </td>
          <td style="padding:0px;border:0px;color:#808080">
              <a href="${object.doc_link}" style="text-decoration:underline;color:#606060" target="_blank">Documentation</a> about <span class="il">Vauxoo's Runbot</span> and <a href="${object.dockerdoc_link}" style="text-decoration:underline;color:#606060" target="_blank">generated docker</a>. <br>
                  For help please send a message to Vauxoo's telegram group, choose who receive this notification in your <a href="${object.configfile_link}" style="text-decoration:underline;color:#606060" target="_blank">Config File</a>.
          </td>
        </tr>
      </tbody></table>

<!-- Issues -->
      <div style="padding-top:10px;width:570px">
        <div style="margin-top:20px;border-radius:5px;border:1px solid #adadad;font-size:12px;padding:10px 20px;width:528px">
            <p style="color:#808080;margin-top:0px;margin-bottom:5px"><strong style="font-size:14px">Do you have an issue with Runbot?</strong></p>
            <p style="color:#808080;margin-top:0px;margin-bottom:5px;margin-bottom:5px">Share your problem <a href="${object.shareissue_link}" style="text-decoration:underline;color:#606060" target="_blank">Here</a>.</p>
        </div>
      </div>
            ]]></field>
    </record>
</data>
</openerp>
